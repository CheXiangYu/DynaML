
<!DOCTYPE html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
        <meta name="description" content="User guide and documentation for the DynaML machine learning library and API">
      
      
        <link rel="canonical" href="https://transcendent-ai-labs.github.io/DynaML/core/core_kernels/">
      
      
        <meta name="author" content="Mandar Chandorkar">
      
      
        <link rel="shortcut icon" href="../../images/dynaml_logo3.png">
      
      <meta name="generator" content="mkdocs-0.16.3, mkdocs-material-1.7.0">
    
    
      
        <title>Kernel API - DynaML User Guide</title>
      
    
    
      <script src="../../assets/javascripts/modernizr-1df76c4e58.js"></script>
    
    
      <link rel="stylesheet" href="../../assets/stylesheets/application-c147e0d28f.css">
      
        <link rel="stylesheet" href="../../assets/stylesheets/application-8817cfa535.palette.css">
      
    
    
      
        
        
        
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,400,400i,700|Roboto+Mono">
        <style>body,input{font-family:"Roboto","Helvetica Neue",Helvetica,Arial,sans-serif}code,kbd,pre{font-family:"Roboto Mono","Courier New",Courier,monospace}</style>
      
      <link rel="stylesheet" href="https://fonts.googleapis.com/icon?family=Material+Icons">
    
    
    
  </head>
  
  
  
  
    <body data-md-color-primary="teal" data-md-color-accent="green">
  
    <svg class="md-svg">
      <defs>
        
        
          <svg xmlns="http://www.w3.org/2000/svg" width="416" height="448" viewBox="0 0 416 448" id="github"><path fill="currentColor" d="M160 304q0 10-3.125 20.5t-10.75 19T128 352t-18.125-8.5-10.75-19T96 304t3.125-20.5 10.75-19T128 256t18.125 8.5 10.75 19T160 304zm160 0q0 10-3.125 20.5t-10.75 19T288 352t-18.125-8.5-10.75-19T256 304t3.125-20.5 10.75-19T288 256t18.125 8.5 10.75 19T320 304zm40 0q0-30-17.25-51T296 232q-10.25 0-48.75 5.25Q229.5 240 208 240t-39.25-2.75Q130.75 232 120 232q-29.5 0-46.75 21T56 304q0 22 8 38.375t20.25 25.75 30.5 15 35 7.375 37.25 1.75h42q20.5 0 37.25-1.75t35-7.375 30.5-15 20.25-25.75T360 304zm56-44q0 51.75-15.25 82.75-9.5 19.25-26.375 33.25t-35.25 21.5-42.5 11.875-42.875 5.5T212 416q-19.5 0-35.5-.75t-36.875-3.125-38.125-7.5-34.25-12.875T37 371.5t-21.5-28.75Q0 312 0 260q0-59.25 34-99-6.75-20.5-6.75-42.5 0-29 12.75-54.5 27 0 47.5 9.875t47.25 30.875Q171.5 96 212 96q37 0 70 8 26.25-20.5 46.75-30.25T376 64q12.75 25.5 12.75 54.5 0 21.75-6.75 42 34 40 34 99.5z"/></svg>
        
      </defs>
    </svg>
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="drawer">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="search">
    <label class="md-overlay" data-md-component="overlay" for="drawer"></label>
    
      <header class="md-header" data-md-component="header">
  <nav class="md-header-nav md-grid">
    <div class="md-flex">
      <div class="md-flex__cell md-flex__cell--shrink">
        
          <a href="https://transcendent-ai-labs.github.io/DynaML" title="DynaML User Guide" class="md-logo md-header-nav__button">
            <img src="../../images/dynaml_logo3_small.png" width="24" height="24">
          </a>
        
      </div>
      <div class="md-flex__cell md-flex__cell--shrink">
        <label class="md-icon md-icon--menu md-header-nav__button" for="drawer"></label>
      </div>
      <div class="md-flex__cell md-flex__cell--stretch">
        <span class="md-flex__ellipsis md-header-nav__title">
          
            
              
                <span class="md-header-nav__parent">
                  Core
                </span>
              
                <span class="md-header-nav__parent">
                  Kernels
                </span>
              
            
            Kernel API
          
        </span>
      </div>
      <div class="md-flex__cell md-flex__cell--shrink">
        
          <label class="md-icon md-icon--search md-header-nav__button" for="search"></label>
          
<div class="md-search" data-md-component="search">
  <label class="md-search__overlay" for="search"></label>
  <div class="md-search__inner">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" required placeholder="Search" accesskey="s" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="query">
      <label class="md-icon md-search__icon" for="search"></label>
      <button type="reset" class="md-icon md-search__icon" data-md-component="reset">close</button>
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="result" data-md-lang-search="">
          <div class="md-search-result__meta" data-md-lang-result-none="No matching documents" data-md-lang-result-one="1 matching document" data-md-lang-result-other="# matching documents">
            Type to start searching
          </div>
          <ol class="md-search-result__list"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
        
      </div>
      <div class="md-flex__cell md-flex__cell--shrink">
        <div class="md-header-nav__source">
          
            


  


  <a href="https://github.com/transcendent-ai-labs/DynaML" title="Go to repository" class="md-source" data-md-source="github">
    
      <div class="md-source__icon">
        <svg viewBox="0 0 24 24" width="24" height="24">
          <use xlink:href="#github" width="24" height="24"></use>
        </svg>
      </div>
    
    <div class="md-source__repository">
      transcendent-ai-labs/DynaML
    </div>
  </a>

          
        </div>
      </div>
    </div>
  </nav>
</header>
    
    <div class="md-container">
      
      
      <main class="md-main">
        <div class="md-main__inner md-grid" data-md-component="container">
          
            
              <div class="md-sidebar md-sidebar--primary" data-md-component="navigation">
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    <nav class="md-nav md-nav--primary" data-md-level="0">
  <label class="md-nav__title md-nav__title--site" for="drawer">
    
      <i class="md-logo md-nav__button">
        <img src="../../images/dynaml_logo3_small.png">
      </i>
    
    DynaML User Guide
  </label>
  
    <div class="md-nav__source">
      


  


  <a href="https://github.com/transcendent-ai-labs/DynaML" title="Go to repository" class="md-source" data-md-source="github">
    
      <div class="md-source__icon">
        <svg viewBox="0 0 24 24" width="24" height="24">
          <use xlink:href="#github" width="24" height="24"></use>
        </svg>
      </div>
    
    <div class="md-source__repository">
      transcendent-ai-labs/DynaML
    </div>
  </a>

    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
      


  <li class="md-nav__item">
    <a href="../.." title="DynaML" class="md-nav__link">
      DynaML
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-2" type="checkbox" id="nav-2">
    
    <label class="md-nav__link" for="nav-2">
      Getting DynaML
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-2">
        Getting DynaML
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../installation/installation/" title="Installation" class="md-nav__link">
      Installation
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../installation/include/" title="Import" class="md-nav__link">
      Import
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="../../supported_features/" title="Supported Features" class="md-nav__link">
      Supported Features
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="../../structure/" title="Structure" class="md-nav__link">
      Structure
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-5" type="checkbox" id="nav-5">
    
    <label class="md-nav__link" for="nav-5">
      Releases
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-5">
        Releases
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-5-1" type="checkbox" id="nav-5-1">
    
    <label class="md-nav__link" for="nav-5-1">
      v1.5.x
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="2">
      <label class="md-nav__title" for="nav-5-1">
        v1.5.x
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../releases/mydoc_release_notes_151/" title="v1.5.1" class="md-nav__link">
      v1.5.1
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../releases/mydoc_release_notes_15/" title="v1.5" class="md-nav__link">
      v1.5
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-5-2" type="checkbox" id="nav-5-2">
    
    <label class="md-nav__link" for="nav-5-2">
      v1.4.x
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="3">
      <label class="md-nav__title" for="nav-5-2">
        v1.4.x
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../releases/mydoc_release_notes_143/" title="v1.4.3" class="md-nav__link">
      v1.4.3
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../releases/mydoc_release_notes_142/" title="v1.4.2" class="md-nav__link">
      v1.4.2
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../releases/mydoc_release_notes_141/" title="v1.4.1" class="md-nav__link">
      v1.4.1
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../releases/mydoc_release_notes_14/" title="v1.4" class="md-nav__link">
      v1.4
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-6" type="checkbox" id="nav-6">
    
    <label class="md-nav__link" for="nav-6">
      Scaladoc
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-6">
        Scaladoc
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-6-1" type="checkbox" id="nav-6-1">
    
    <label class="md-nav__link" for="nav-6-1">
      v1.5.x
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="2">
      <label class="md-nav__title" for="nav-6-1">
        v1.5.x
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-6-1-1" type="checkbox" id="nav-6-1-1">
    
    <label class="md-nav__link" for="nav-6-1-1">
      v1.5.1
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="3">
      <label class="md-nav__title" for="nav-6-1-1">
        v1.5.1
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../scaladoc/v1.5.1/core/" title="dynaml-core" class="md-nav__link">
      dynaml-core
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../scaladoc/v1.5.1/pipes/" title="dynaml-pipes" class="md-nav__link">
      dynaml-pipes
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../scaladoc/v1.5.1/examples/" title="dynaml-examples" class="md-nav__link">
      dynaml-examples
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-6-1-2" type="checkbox" id="nav-6-1-2">
    
    <label class="md-nav__link" for="nav-6-1-2">
      v1.5
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="4">
      <label class="md-nav__title" for="nav-6-1-2">
        v1.5
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../scaladoc/v1.5/core/" title="dynaml-core" class="md-nav__link">
      dynaml-core
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../scaladoc/v1.5/pipes/" title="dynaml-pipes" class="md-nav__link">
      dynaml-pipes
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../scaladoc/v1.5/examples/" title="dynaml-examples" class="md-nav__link">
      dynaml-examples
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

        
      </ul>
    </nav>
  </li>

        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-6-2" type="checkbox" id="nav-6-2">
    
    <label class="md-nav__link" for="nav-6-2">
      v1.4.x
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="3">
      <label class="md-nav__title" for="nav-6-2">
        v1.4.x
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-6-2-1" type="checkbox" id="nav-6-2-1">
    
    <label class="md-nav__link" for="nav-6-2-1">
      v1.4.3
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="4">
      <label class="md-nav__title" for="nav-6-2-1">
        v1.4.3
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../scaladoc/v1.4.3/core/" title="dynaml-core" class="md-nav__link">
      dynaml-core
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../scaladoc/v1.4.3/pipes/" title="dynaml-pipes" class="md-nav__link">
      dynaml-pipes
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../scaladoc/v1.4.3/examples/" title="dynaml-examples" class="md-nav__link">
      dynaml-examples
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-6-2-2" type="checkbox" id="nav-6-2-2">
    
    <label class="md-nav__link" for="nav-6-2-2">
      v1.4.2
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="5">
      <label class="md-nav__title" for="nav-6-2-2">
        v1.4.2
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../scaladoc/v1.4.2/core/" title="dynaml-core" class="md-nav__link">
      dynaml-core
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../scaladoc/v1.4.2/pipes/" title="dynaml-pipes" class="md-nav__link">
      dynaml-pipes
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../scaladoc/v1.4.2/examples/" title="dynaml-examples" class="md-nav__link">
      dynaml-examples
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-6-2-3" type="checkbox" id="nav-6-2-3">
    
    <label class="md-nav__link" for="nav-6-2-3">
      v1.4.1
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="6">
      <label class="md-nav__title" for="nav-6-2-3">
        v1.4.1
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../scaladoc/v1.4.1/core/" title="dynaml-core" class="md-nav__link">
      dynaml-core
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../scaladoc/v1.4.1/pipes/" title="dynaml-pipes" class="md-nav__link">
      dynaml-pipes
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../scaladoc/v1.4.1/examples/" title="dynaml-examples" class="md-nav__link">
      dynaml-examples
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-6-2-4" type="checkbox" id="nav-6-2-4">
    
    <label class="md-nav__link" for="nav-6-2-4">
      v1.4
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="7">
      <label class="md-nav__title" for="nav-6-2-4">
        v1.4
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../scaladoc/v1.4/core/" title="dynaml-core" class="md-nav__link">
      dynaml-core
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../scaladoc/v1.4/pipes/" title="dynaml-pipes" class="md-nav__link">
      dynaml-pipes
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../scaladoc/v1.4/examples/" title="dynaml-examples" class="md-nav__link">
      dynaml-examples
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

        
      </ul>
    </nav>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      

  


  <li class="md-nav__item md-nav__item--active md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-7" type="checkbox" id="nav-7" checked>
    
    <label class="md-nav__link" for="nav-7">
      User Guide
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-7">
        User Guide
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          

  


  <li class="md-nav__item md-nav__item--active md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-7-1" type="checkbox" id="nav-7-1" checked>
    
    <label class="md-nav__link" for="nav-7-1">
      Core
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="2">
      <label class="md-nav__title" for="nav-7-1">
        Core
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-7-1-1" type="checkbox" id="nav-7-1-1">
    
    <label class="md-nav__link" for="nav-7-1-1">
      Models
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="3">
      <label class="md-nav__title" for="nav-7-1-1">
        Models
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../core_model_hierarchy/" title="Model Hierarchy" class="md-nav__link">
      Model Hierarchy
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-7-1-1-2" type="checkbox" id="nav-7-1-1-2">
    
    <label class="md-nav__link" for="nav-7-1-1-2">
      Linear Models
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="5">
      <label class="md-nav__title" for="nav-7-1-1-2">
        Linear Models
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../core_glm/" title="Generalized Linear Models" class="md-nav__link">
      Generalized Linear Models
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../core_gls/" title="Generalized Least Squares" class="md-nav__link">
      Generalized Least Squares
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-7-1-1-3" type="checkbox" id="nav-7-1-1-3">
    
    <label class="md-nav__link" for="nav-7-1-1-3">
      Stochastic Processes
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="6">
      <label class="md-nav__title" for="nav-7-1-1-3">
        Stochastic Processes
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../core_gp/" title="Gaussian Processes" class="md-nav__link">
      Gaussian Processes
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../core_esgp/" title="Extended Skew Gaussian Processes" class="md-nav__link">
      Extended Skew Gaussian Processes
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../core_stp/" title="Students T Processes" class="md-nav__link">
      Students T Processes
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../core_multi_output_t/" title="Multi-output Matrix T Process" class="md-nav__link">
      Multi-output Matrix T Process
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-7-1-1-4" type="checkbox" id="nav-7-1-1-4">
    
    <label class="md-nav__link" for="nav-7-1-1-4">
      Neural Networks
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="7">
      <label class="md-nav__title" for="nav-7-1-1-4">
        Neural Networks
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../core_ffn_new/" title="Feed Forward Networks" class="md-nav__link">
      Feed Forward Networks
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../core_ann_new/" title="Neural Stack API" class="md-nav__link">
      Neural Stack API
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../core_ann/" title="Old Neural Net API" class="md-nav__link">
      Old Neural Net API
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../core_lssvm/" title="Least Squares SVM" class="md-nav__link">
      Least Squares SVM
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

        
          
          
          

  


  <li class="md-nav__item md-nav__item--active md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-7-1-2" type="checkbox" id="nav-7-1-2" checked>
    
    <label class="md-nav__link" for="nav-7-1-2">
      Kernels
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="4">
      <label class="md-nav__title" for="nav-7-1-2">
        Kernels
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          

  


  <li class="md-nav__item md-nav__item--active">
    
    <input class="md-toggle md-nav__toggle" data-md-toggle="toc" type="checkbox" id="toc">
    
    
      <label class="md-nav__link md-nav__link--active" for="toc">
        Kernel API
      </label>
    
    <a href="./" title="Kernel API" class="md-nav__link md-nav__link--active">
      Kernel API
    </a>
    
      
<nav class="md-nav md-nav--secondary">
  
  
  
    <label class="md-nav__title" for="toc">Table of contents</label>
    <ul class="md-nav__list" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#kernel-api" title="Kernel API" class="md-nav__link">
    Kernel API
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#creating-arbitrary-kernel-functions" title="Creating arbitrary kernel functions" class="md-nav__link">
    Creating arbitrary kernel functions
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#constructing-kernels-via-feature-maps" title="Constructing kernels via feature maps" class="md-nav__link">
    Constructing kernels via feature maps
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#constructing-kernels-via-direct-evaluation" title="Constructing kernels via direct evaluation" class="md-nav__link">
    Constructing kernels via direct evaluation
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#creating-composite-kernels" title="Creating Composite Kernels" class="md-nav__link">
    Creating Composite Kernels
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#algebraic-operations" title="Algebraic Operations" class="md-nav__link">
    Algebraic Operations
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#composition" title="Composition" class="md-nav__link">
    Composition
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#scaling-covariances" title="Scaling Covariances" class="md-nav__link">
    Scaling Covariances
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#advanced-composite-kernels" title="Advanced Composite Kernels" class="md-nav__link">
    Advanced Composite Kernels
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
      
      
        <li class="md-nav__item">
          <a href="#__comments" title="Comments" class="md-nav__link md-nav__link--active">
            Comments
          </a>
        </li>
      
    </ul>
  
</nav>
    
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../core_kernel_stat/" title="Stationary Kernels" class="md-nav__link">
      Stationary Kernels
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../core_kernel_nonstat/" title="Non Stationary Kernels" class="md-nav__link">
      Non Stationary Kernels
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../core_kernel_nystrom/" title="Automatic Feature Extraction" class="md-nav__link">
      Automatic Feature Extraction
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-7-1-3" type="checkbox" id="nav-7-1-3">
    
    <label class="md-nav__link" for="nav-7-1-3">
      Algebra
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="5">
      <label class="md-nav__title" for="nav-7-1-3">
        Algebra
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../partitioned_objects/" title="Blocked Algebraic Objects" class="md-nav__link">
      Blocked Algebraic Objects
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../partitioned_vectors/" title="Block Vectors" class="md-nav__link">
      Block Vectors
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../partitioned_matrices/" title="Block Matrices" class="md-nav__link">
      Block Matrices
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../partitioned_alg_utils/" title="Block Algebra Utilities" class="md-nav__link">
      Block Algebra Utilities
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-7-1-4" type="checkbox" id="nav-7-1-4">
    
    <label class="md-nav__link" for="nav-7-1-4">
      Probability
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="6">
      <label class="md-nav__title" for="nav-7-1-4">
        Probability
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../core_prob_randomvar/" title="Random Variables" class="md-nav__link">
      Random Variables
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../core_prob_operations/" title="Operations on Random Variables" class="md-nav__link">
      Operations on Random Variables
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../core_prob_dist/" title="Probability Distributions" class="md-nav__link">
      Probability Distributions
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-7-1-5" type="checkbox" id="nav-7-1-5">
    
    <label class="md-nav__link" for="nav-7-1-5">
      Optimizers & Solvers
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="7">
      <label class="md-nav__title" for="nav-7-1-5">
        Optimizers & Solvers
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../core_opt_convex/" title="Convex" class="md-nav__link">
      Convex
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../core_opt_global/" title="Global" class="md-nav__link">
      Global
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../core_model_evaluation/" title="Performance Evaluation" class="md-nav__link">
      Performance Evaluation
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-7-2" type="checkbox" id="nav-7-2">
    
    <label class="md-nav__link" for="nav-7-2">
      Pipes
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="3">
      <label class="md-nav__title" for="nav-7-2">
        Pipes
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../pipes/pipes/" title="DynaML Pipes" class="md-nav__link">
      DynaML Pipes
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../pipes/pipes_api/" title="Pipes API" class="md-nav__link">
      Pipes API
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../pipes/pipes_scalers_encoders/" title="Scalers & Encoders" class="md-nav__link">
      Scalers & Encoders
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../pipes/model_pipes/" title="Model Pipes" class="md-nav__link">
      Model Pipes
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-7-2-5" type="checkbox" id="nav-7-2-5">
    
    <label class="md-nav__link" for="nav-7-2-5">
      DynaML Pipes Library
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="8">
      <label class="md-nav__title" for="nav-7-2-5">
        DynaML Pipes Library
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../pipes/file_processing/" title="String & File Processing" class="md-nav__link">
      String & File Processing
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../pipes/feature_processing/" title="Feature Processing" class="md-nav__link">
      Feature Processing
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../pipes/pipes_time_series/" title="Time Series" class="md-nav__link">
      Time Series
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../pipes/pipes_models/" title="Workflows on Models" class="md-nav__link">
      Workflows on Models
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../pipes/pipes_misc/" title="Miscellaneuos" class="md-nav__link">
      Miscellaneuos
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../pipes/pipes_library/" title="Pipes Example" class="md-nav__link">
      Pipes Example
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-7-3" type="checkbox" id="nav-7-3">
    
    <label class="md-nav__link" for="nav-7-3">
      REPL Examples
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="4">
      <label class="md-nav__title" for="nav-7-3">
        REPL Examples
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../repl-examples/p2_examples/" title="Examples Module" class="md-nav__link">
      Examples Module
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../repl-examples/p2_boston_housing/" title="Boston Housing" class="md-nav__link">
      Boston Housing
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../repl-examples/p2_winequality_logistic/" title="Wine Quality" class="md-nav__link">
      Wine Quality
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../repl-examples/p2_lssvm_powerplant/" title="Pont-sur-Sambre Power Plant" class="md-nav__link">
      Pont-sur-Sambre Power Plant
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-7-4" type="checkbox" id="nav-7-4">
    
    <label class="md-nav__link" for="nav-7-4">
      Misc. Utilities
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="5">
      <label class="md-nav__title" for="nav-7-4">
        Misc. Utilities
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../utils/utils_data_transforms/" title="Data Transforms" class="md-nav__link">
      Data Transforms
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../utils/package/" title="`utils` object" class="md-nav__link">
      `utils` object
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="../../license/" title="License" class="md-nav__link">
      License
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="../../about/" title="About Us" class="md-nav__link">
      About Us
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-10" type="checkbox" id="nav-10">
    
    <label class="md-nav__link" for="nav-10">
      DynaML Blog
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-10">
        DynaML Blog
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../blog/2016-12-11-dynaml-new-features/" title="State of DynaML 2016" class="md-nav__link">
      State of DynaML 2016
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../blog/2016-12-08-getting-started-ml/" title="Resources for Beginners" class="md-nav__link">
      Resources for Beginners
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              <div class="md-sidebar md-sidebar--secondary" data-md-component="toc">
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    
<nav class="md-nav md-nav--secondary">
  
  
  
    <label class="md-nav__title" for="toc">Table of contents</label>
    <ul class="md-nav__list" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#kernel-api" title="Kernel API" class="md-nav__link">
    Kernel API
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#creating-arbitrary-kernel-functions" title="Creating arbitrary kernel functions" class="md-nav__link">
    Creating arbitrary kernel functions
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#constructing-kernels-via-feature-maps" title="Constructing kernels via feature maps" class="md-nav__link">
    Constructing kernels via feature maps
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#constructing-kernels-via-direct-evaluation" title="Constructing kernels via direct evaluation" class="md-nav__link">
    Constructing kernels via direct evaluation
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#creating-composite-kernels" title="Creating Composite Kernels" class="md-nav__link">
    Creating Composite Kernels
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#algebraic-operations" title="Algebraic Operations" class="md-nav__link">
    Algebraic Operations
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#composition" title="Composition" class="md-nav__link">
    Composition
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#scaling-covariances" title="Scaling Covariances" class="md-nav__link">
    Scaling Covariances
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#advanced-composite-kernels" title="Advanced Composite Kernels" class="md-nav__link">
    Advanced Composite Kernels
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
      
      
        <li class="md-nav__item">
          <a href="#__comments" title="Comments" class="md-nav__link md-nav__link--active">
            Comments
          </a>
        </li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          <div class="md-content">
            <article class="md-content__inner md-typeset">
              
                
                
                  <h1>Kernel API</h1>
                
                <div class="admonition summary">
<p>The <a href="https://transcendent-ai-labs.github.io/api_docs/DynaML/recent/dynaml-core/#io.github.mandar2812.dynaml.kernels.package"><code>dynaml.kernels</code></a> package has a highly developed API for creating kernel functions for machine learning applications. Here
we give the user an in-depth introduction to its capabilities.</p>
</div>
<p><br/></p>
<p><img alt="kernel" src="../../images/kernel.png" /></p>
<p><em>Positive definite</em> functions or <em>positive type</em> functions occupy an important place in various areas of mathematics, from the construction of covariances of random variables to quantifying distance measures in <em>Hilbert spaces</em>. Symmetric positive type functions defined on the cartesian product of a set with itself <span>\(K: \mathcal{X} \times \mathcal{X} \rightarrow \mathbb{R}\)</span> are also known as <em>kernel</em> functions in machine learning. They are applied extensively in problems such as.</p>
<ol>
<li>Model non-linear behavior in SVM models: <a href="https://en.wikipedia.org/wiki/Support_vector_machine"><em>SVM</em></a> and <a href="http://www.worldscientific.com/worldscibooks/10.1142/5089"><em>LSSVM</em></a></li>
<li>Quantify covariance between input patterns: <a href="http://www.gaussianprocess.org/gpml/"><em>Gaussian Processes</em></a></li>
<li>Represent degree of 'closeness' or affinity in unsupervised learning: <a href="http://arxiv.org/pdf/1505.00477.pdf"><em>Kernel Spectral Clustering</em></a></li>
</ol>
<p>For an in depth review of the various applications of kernels in the machine learning domain, refer to <a href="http://www.kernel-machines.org/publications/pdfs/0701907.pdf">Scholkopf et. al</a></p>
<div class="admonition note">
<p class="admonition-title">Nomenclature</p>
<p>In the machine learning community the words <em>kernel</em> and <em>covariance function</em> are used interchangeably.</p>
</div>
<h2 id="kernel-api">Kernel API<a class="headerlink" href="#kernel-api" title="Permanent link">&para;</a></h2>
<p>The kernel class hierarchy all stems from a simple trait shown here.</p>
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3</pre></div></td><td class="code"><div class="codehilite"><pre><span></span><span class="k">trait</span> <span class="nc">Kernel</span><span class="o">[</span><span class="kt">T</span>, <span class="kt">V</span><span class="o">]</span> <span class="o">{</span>
  <span class="k">def</span> <span class="n">evaluate</span><span class="o">(</span><span class="n">x</span><span class="k">:</span> <span class="kt">T</span><span class="o">,</span> <span class="n">y</span><span class="k">:</span> <span class="kt">T</span><span class="o">)</span><span class="k">:</span> <span class="kt">V</span>
<span class="o">}</span>
</pre></div>
</td></tr></table>

<p>This outlines only one key feature for kernel functions i.e. their evaluation functional which takes two inputs from <span>\(\mathcal{X}\)</span> and yields a scalar value.</p>
<div class="admonition note">
<p class="admonition-title"><code class="codehilite"><span class="nc">Kernel</span></code> vs <code class="codehilite"><span class="nc">CovarianceFunction</span></code></p>
<p><br/>
For practical purposes, the <a href="https://transcendent-ai-labs.github.io/api_docs/DynaML/recent/dynaml-core/index.html#io.github.mandar2812.dynaml.kernels.Kernel"><code class="codehilite"><span class="nc">Kernel</span><span class="o">[</span><span class="kt">T</span>, <span class="kt">V</span><span class="o">]</span></code></a> trait does not have enough functionality for usage in varied models like <a href="../core_gp/"><em>Gaussian Processes</em></a>, <a href="../core_stp/"><em>Student's T Processes</em></a>, <a href="../core_lssvm/"><em>LS-SVM</em></a> etc.</p>
<p>For this reason there is the <a href="https://transcendent-ai-labs.github.io/api_docs/DynaML/recent/dynaml-core/index.html#io.github.mandar2812.dynaml.kernels.CovarianceFunction"><code class="codehilite"><span class="nc">CovarianceFunction</span><span class="o">[</span><span class="kt">T</span>, <span class="kt">V</span>, <span class="kt">M</span><span class="o">]</span></code></a> abstract class. It contains methods to construct kernel matrices, keep track of hyper-parameter assignments among other things.</p>
</div>
<h2 id="creating-arbitrary-kernel-functions">Creating arbitrary kernel functions<a class="headerlink" href="#creating-arbitrary-kernel-functions" title="Permanent link">&para;</a></h2>
<p>Apart from off the shelf kernel functions, it is also possible to create custom kernels on the fly by using the <code class="codehilite"><span class="nc">CovarianceFunction</span></code> object.</p>
<h3 id="constructing-kernels-via-feature-maps">Constructing kernels via feature maps<a class="headerlink" href="#constructing-kernels-via-feature-maps" title="Permanent link">&para;</a></h3>
<p>It is known from <a href="https://en.wikipedia.org/wiki/Mercer%27s_theorem">Mercer's theorem</a> that any valid kernel function must be decomposable as a dot product between certain <em>basis function</em> representation of the inputs. This translates mathematically into.</p>
<span>\[
\begin{align}
    &amp; K(\mathbf{x}, \mathbf{y}) = \varphi^{T}(\mathbf{x}) . \varphi(\mathbf{y}) \\
    &amp; \varphi(.): \mathcal{X} \rightarrow \mathbb{R}^n
\end{align}
\]</span><p>The function <span>\(\varphi(.)\)</span> is some higher (possibly infinite) dimensional representation of the input features of a data point. Note that the input space <span>\(\mathcal{X}\)</span> could be any of the following (but not limited to).</p>
<ul>
<li>
<p>The space of all connection graphs with specific number of nodes.</p>
</li>
<li>
<p>A multi-dimensional vector.</p>
</li>
<li>
<p>The space of all character sequences (binary or otherwise) up to a certain length.</p>
</li>
<li>
<p>The set of all integer tuples e.g. <span>\((1,2), (6,10), \cdots\)</span></p>
</li>
</ul>
<p>We can use any function from some domain <span>\(\mathcal{X}\)</span> yielding a <code class="codehilite"><span class="nc">DenseVector</span><span class="o">[</span><span class="kt">Double</span><span class="o">]</span></code> to define a particular inner product/kernel function.</p>
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3
4
5
6
7
8
9</pre></div></td><td class="code"><div class="codehilite"><pre><span></span><span class="c1">// First create a function mapping from some input space to</span>
<span class="c1">// Breeze dense vectors.</span>

<span class="k">val</span> <span class="n">mapFunc</span> <span class="k">=</span> <span class="o">(</span><span class="n">vec</span><span class="k">:</span> <span class="kt">DenseVector</span><span class="o">[</span><span class="kt">Double</span><span class="o">])</span> <span class="k">=&gt;</span> <span class="o">{</span>
    <span class="k">val</span> <span class="n">mat</span> <span class="k">=</span> <span class="n">vec</span> <span class="o">*</span> <span class="n">vec</span><span class="o">.</span><span class="n">t</span>
    <span class="n">mat</span><span class="o">.</span><span class="n">toDenseVector</span>
<span class="o">}</span>

<span class="k">val</span> <span class="n">kernel</span> <span class="k">=</span> <span class="nc">CovarianceFunction</span><span class="o">(</span><span class="n">mapFunc</span><span class="o">)</span>
</pre></div>
</td></tr></table>

<div class="admonition note">
<p class="admonition-title">Feature map kernels</p>
<p>Covariance functions constructed using feature mappings as shown above return a special object; an instance of the <code class="codehilite"><span class="nc">FeatureMapCovariance</span><span class="o">[</span><span class="kt">T</span>, <span class="kt">DenseVector</span><span class="o">[</span><span class="kt">Double</span><span class="o">]]</span></code> class. In the section on composite kernels we will see why this is important.</p>
</div>
<h3 id="constructing-kernels-via-direct-evaluation">Constructing kernels via direct evaluation<a class="headerlink" href="#constructing-kernels-via-direct-evaluation" title="Permanent link">&para;</a></h3>
<p>Instead of defining a feature representation like <span>\(\varphi(.)\)</span> as in the section above, you can also directly define the evaluation expression of the kernel.</p>
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11</pre></div></td><td class="code"><div class="codehilite"><pre><span></span><span class="c1">// Create the expression for the required kernel.</span>
<span class="k">val</span> <span class="n">mapFunc</span> <span class="k">=</span>
<span class="o">(</span><span class="n">state</span><span class="k">:</span> <span class="kt">Map</span><span class="o">[</span><span class="kt">String</span>, <span class="kt">Double</span><span class="o">])</span> <span class="k">=&gt;</span>
  <span class="o">(</span><span class="n">x</span><span class="k">:</span> <span class="kt">DenseVector</span><span class="o">[</span><span class="kt">Double</span><span class="o">],</span> <span class="n">y</span><span class="k">:</span> <span class="kt">DenseVector</span><span class="o">[</span><span class="kt">Double</span><span class="o">])</span> <span class="k">=&gt;</span> <span class="o">{</span>
       <span class="n">state</span><span class="o">(</span><span class="s">&quot;alpha&quot;</span><span class="o">)*(</span><span class="n">x</span> <span class="n">dot</span> <span class="n">y</span><span class="o">)</span> <span class="o">+</span> <span class="n">state</span><span class="o">(</span><span class="s">&quot;intercept&quot;</span><span class="o">)</span>
  <span class="o">}</span>

<span class="c1">//Creates kernel with two hyper-parameters: alpha and intercept</span>
<span class="k">val</span> <span class="n">kernel</span> <span class="k">=</span> <span class="nc">CovarianceFunction</span><span class="o">(</span><span class="n">mapFunc</span><span class="o">)(</span>
  <span class="nc">Map</span><span class="o">(</span><span class="s">&quot;alpha&quot;</span> <span class="o">-&gt;</span> <span class="mf">1.5</span><span class="o">,</span> <span class="s">&quot;intercept&quot;</span> <span class="o">-&gt;</span> <span class="mf">0.01</span><span class="o">)</span>
<span class="o">)</span>
</pre></div>
</td></tr></table>

<hr />
<h2 id="creating-composite-kernels">Creating Composite Kernels<a class="headerlink" href="#creating-composite-kernels" title="Permanent link">&para;</a></h2>
<h3 id="algebraic-operations">Algebraic Operations<a class="headerlink" href="#algebraic-operations" title="Permanent link">&para;</a></h3>
<p>In machine learning it is well known that kernels can be combined to give other valid kernels. The symmetric positive semi-definite property of a kernel is preserved as long as it is added or multiplied to another valid kernel. In DynaML adding and multiplying kernels is elementary.</p>
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3
4
5</pre></div></td><td class="code"><div class="codehilite"><pre><span></span><span class="k">val</span> <span class="n">k1</span> <span class="k">=</span> <span class="k">new</span> <span class="nc">RBFKernel</span><span class="o">(</span><span class="mf">2.5</span><span class="o">)</span>
<span class="k">val</span> <span class="n">k2</span> <span class="k">=</span> <span class="k">new</span> <span class="nc">RationalQuadraticKernel</span><span class="o">(</span><span class="mf">2.0</span><span class="o">)</span>

<span class="k">val</span> <span class="n">k</span> <span class="k">=</span> <span class="n">k1</span> <span class="o">+</span> <span class="n">k2</span>
<span class="k">val</span> <span class="n">k3</span> <span class="k">=</span> <span class="n">k</span><span class="o">*</span><span class="n">k2</span>
</pre></div>
</td></tr></table>

<h3 id="composition">Composition<a class="headerlink" href="#composition" title="Permanent link">&para;</a></h3>
<p>From Mercer's theorem, every kernel can be expressed as a dot product of feature mappings evaluated at the respective data points. We can use this to construct more complex covariances i.e. by successively applying feature mappings.</p>
<span>\[
\begin{align}
C_{a}(\mathbf{x}, \mathbf{y}) &amp;= \varphi_{a}(\mathbf{x})^\intercal \varphi_{a}(\mathbf{y}) \\
C_{b}(\mathbf{x}, \mathbf{y}) &amp;= \varphi_{b}(\mathbf{x})^\intercal \varphi_{b}(\mathbf{y}) \\
C_{b . a}(\mathbf{x}, \mathbf{y}) &amp;= \varphi_{b}(\varphi_{a}(\mathbf{x}))^\intercal \varphi_{b}(\varphi_{a}(\mathbf{y}))
\end{align}
\]</span><p>In DynaML, we can create a composite kernel if the kernel represented by the map <span>\(\varphi_{a}\)</span>, is explicitly of type <code class="codehilite"><span class="nc">FeatureMapCovariance</span><span class="o">[</span><span class="kt">T</span>, <span class="kt">DenseVector</span><span class="o">[</span><span class="kt">Double</span><span class="o">]]</span></code></p>
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10</pre></div></td><td class="code"><div class="codehilite"><pre><span></span><span class="k">val</span> <span class="n">mapFunc</span> <span class="k">=</span> <span class="o">(</span><span class="n">vec</span><span class="k">:</span> <span class="kt">DenseVector</span><span class="o">[</span><span class="kt">Double</span><span class="o">])</span> <span class="k">=&gt;</span> <span class="o">{</span>
    <span class="n">vec</span><span class="o">/</span><span class="mi">2</span><span class="n">d</span>
<span class="o">}</span>

<span class="k">val</span> <span class="n">k1</span> <span class="k">=</span> <span class="nc">CovarianceFunction</span><span class="o">(</span><span class="n">mapFunc</span><span class="o">)</span>

<span class="k">val</span> <span class="n">k2</span> <span class="k">=</span> <span class="k">new</span> <span class="nc">RationalQuadraticKernel</span><span class="o">(</span><span class="mf">2.0</span><span class="o">)</span>

<span class="c1">//Composite kernel</span>
<span class="k">val</span> <span class="n">k3</span> <span class="k">=</span> <span class="n">k2</span> <span class="o">&gt;</span> <span class="n">k1</span>
</pre></div>
</td></tr></table>

<h3 id="scaling-covariances">Scaling Covariances<a class="headerlink" href="#scaling-covariances" title="Permanent link">&para;</a></h3>
<p>If <span>\(C(\mathbf{x}, \mathbf{y})\)</span> is a valid covariance function, then <span>\(g(\mathbf{x}) C(\mathbf{x}, \mathbf{y}) g(\mathbf{x})\)</span> is also a valid covariance function, where <span>\(g(.): \mathcal{X} \rightarrow \mathbb{R}\)</span> is a non-negative function from the domain of the inputs <span>\(\mathcal{X}\)</span> to the real number line. We call these covariances <em>scaled covariance functions</em>.</p>
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3
4
5
6
7</pre></div></td><td class="code"><div class="codehilite"><pre><span></span><span class="c1">//Instantiate some kernel</span>
<span class="k">val</span> <span class="n">kernel</span><span class="k">:</span> <span class="kt">LocalScalarKernel</span><span class="o">[</span><span class="kt">I</span><span class="o">]</span> <span class="k">=</span> <span class="k">_</span>

<span class="k">val</span> <span class="n">scalingFunction</span><span class="k">:</span> <span class="o">(</span><span class="kt">I</span><span class="o">)</span> <span class="o">=&gt;</span> <span class="nc">Double</span> <span class="k">=</span> <span class="k">_</span>

<span class="k">val</span> <span class="n">scKernel</span> <span class="k">=</span> <span class="nc">ScaledKernel</span><span class="o">(</span>
  <span class="n">kernel</span><span class="o">,</span> <span class="nc">DataPipe</span><span class="o">(</span><span class="n">scalingFunction</span><span class="o">))</span>
</pre></div>
</td></tr></table>

<h3 id="advanced-composite-kernels">Advanced Composite Kernels<a class="headerlink" href="#advanced-composite-kernels" title="Permanent link">&para;</a></h3>
<p>Sometimes we would like to express a kernel function as a product (or sum) of component kernels each of which act on
a sub-set of the dimensions (degree of freedom) of the input attributes.</p>
<p>For example; for 4 dimensional input vector, we may define two component kernels acting on the first two and
last two dimensions respectively and combine their evaluations via addition or multiplication. For this purpose the
<a href="https://transcendent-ai-labs.github.io/api_docs/DynaML/recent/dynaml-core/#io.github.mandar2812.dynaml.kernels.package"><code>dynaml.kernels</code></a> package has the <a href="https://transcendent-ai-labs.github.io/api_docs/DynaML/recent/dynaml-core/#io.github.mandar2812.dynaml.kernels.DecomposableCovariance"><code class="codehilite"><span class="nc">DecomposableCovariance</span><span class="o">[</span><span class="kt">S</span><span class="o">]</span></code></a> class.</p>
<p>In order to create a decomposable kernel you need three components.</p>
<ol>
<li>The component kernels (order matters)</li>
<li>An <a href="https://transcendent-ai-labs.github.io/api_docs/DynaML/recent/dynaml-pipes/#io.github.mandar2812.dynaml.pipes.Encoder"><code class="codehilite"><span class="nc">Encoder</span><span class="o">[</span><span class="kt">S</span>, <span class="kt">Array</span><span class="o">[</span><span class="kt">S</span><span class="o">]]</span></code></a> instance which splits the input into an array of components</li>
<li>A <a href="https://transcendent-ai-labs.github.io/api_docs/DynaML/recent/dynaml-pipes/#io.github.mandar2812.dynaml.pipes.Reducer$"><code class="codehilite"><span class="nc">Reducer</span></code></a> which combines the individual kernel evaluations.</li>
</ol>
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18</pre></div></td><td class="code"><div class="codehilite"><pre><span></span><span class="c1">//Not required in REPL, already imported</span>
<span class="k">import</span> <span class="nn">io.github.mandar2812.dynaml.DynaMLPipe._</span>
<span class="k">import</span> <span class="nn">io.github.mandar2812.dynaml.pipes._</span>

<span class="k">val</span> <span class="n">kernel1</span><span class="k">:</span> <span class="kt">LocalScalarKernel</span><span class="o">[</span><span class="kt">DenseVector</span><span class="o">[</span><span class="kt">Double</span><span class="o">]]</span> <span class="k">=</span> <span class="k">_</span>
<span class="k">val</span> <span class="n">kernel2</span><span class="k">:</span> <span class="kt">LocalScalarKernel</span><span class="o">[</span><span class="kt">DenseVector</span><span class="o">[</span><span class="kt">Double</span><span class="o">]]</span> <span class="k">=</span> <span class="k">_</span>

<span class="c1">//Default Reducer is addition</span>
<span class="k">val</span> <span class="n">decomp_kernel</span> <span class="k">=</span>
  <span class="k">new</span> <span class="nc">DecomposableCovariance</span><span class="o">[</span><span class="kt">DenseVector</span><span class="o">[</span><span class="kt">Double</span><span class="o">]](</span>
    <span class="n">kernel1</span><span class="o">,</span> <span class="n">kernel2</span><span class="o">)(</span>
    <span class="n">breezeDVSplitEncoder</span><span class="o">(</span><span class="mi">2</span><span class="o">))</span>

<span class="k">val</span> <span class="n">decomp_kernel_mult</span> <span class="k">=</span>
  <span class="k">new</span> <span class="nc">DecomposableCovariance</span><span class="o">[</span><span class="kt">DenseVector</span><span class="o">[</span><span class="kt">Double</span><span class="o">]](</span>
    <span class="n">kernel1</span><span class="o">,</span> <span class="n">kernel2</span><span class="o">)(</span>
    <span class="n">breezeDVSplitEncoder</span><span class="o">(</span><span class="mi">2</span><span class="o">),</span>
    <span class="nc">Reducer</span><span class="o">.:*:)</span>
</pre></div>
</td></tr></table>

<hr />
<div class="admonition seealso">
<p class="admonition-title">Implementing Custom Kernels</p>
<p>For more details on implementing user defined kernels, refer to the <a href="https://github.com/mandar2812/DynaML/wiki/Kernels">wiki</a>.</p>
</div>
                
                  
                
              
              
                
                  <h2 id="__comments">Comments</h2>
                  <div id="disqus_thread"></div>
<script>
  var disqus_config = function () {
    this.page.url = "https://transcendent-ai-labs.github.io/DynaML/core/core_kernels/";
    this.page.identifier =
      "/core/core_kernels/";
  };
  (function() {
    var d = document, s = d.createElement("script");
    s.src = "//dynaml.disqus.com/embed.js";
    s.setAttribute("data-timestamp", +new Date());
    (d.head || d.body).appendChild(s);
  })();
</script>
                
              
            </article>
          </div>
        </div>
      </main>
      
        
<footer class="md-footer">
  
    <div class="md-footer-nav">
      <nav class="md-footer-nav__inner md-grid">
        
          <a href="../core_lssvm/" title="Least Squares SVM" class="md-flex md-footer-nav__link md-footer-nav__link--prev" rel="prev">
            <div class="md-flex__cell md-flex__cell--shrink">
              <i class="md-icon md-icon--arrow-back md-footer-nav__button"></i>
            </div>
            <div class="md-flex__cell md-flex__cell--stretch md-footer-nav__title">
              <span class="md-flex__ellipsis">
                <span class="md-footer-nav__direction">
                  Previous
                </span>
                Least Squares SVM
              </span>
            </div>
          </a>
        
        
          <a href="../core_kernel_stat/" title="Stationary Kernels" class="md-flex md-footer-nav__link md-footer-nav__link--next" rel="next">
            <div class="md-flex__cell md-flex__cell--stretch md-footer-nav__title">
              <span class="md-flex__ellipsis">
                <span class="md-footer-nav__direction">
                  Next
                </span>
                Stationary Kernels
              </span>
            </div>
            <div class="md-flex__cell md-flex__cell--shrink">
              <i class="md-icon md-icon--arrow-forward md-footer-nav__button"></i>
            </div>
          </a>
        
      </nav>
    </div>
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-footer-copyright">
        
          <div class="md-footer-copyright__highlight">
            Copyright &copy; 2015 Mandar Chandorkar
          </div>
        
        powered by
        <a href="http://www.mkdocs.org" title="MkDocs">MkDocs</a>
        and
        <a href="http://squidfunk.github.io/mkdocs-material/" title="Material for MkDocs">
          Material for MkDocs</a>
      </div>
      
        
  <div class="md-footer-social">
    
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">
    
      <a href="https://github.com/transcendent-ai-labs" class="md-footer-social__link fa fa-github"></a>
    
      <a href="https://twitter.com/dyna_ml" class="md-footer-social__link fa fa-twitter"></a>
    
  </div>

      
    </div>
  </div>
</footer>
      
    </div>
    
      <script src="../../assets/javascripts/application-e3caa82af6.js"></script>
      
      
      <script>app.initialize({url:{base:"../.."}})</script>
      
        <script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.0/MathJax.js?config=TeX-MML-AM_CHTML"></script>
      
    
    
      
      <script>!function(e,t,a,n,o,c,i){e.GoogleAnalyticsObject=o,e[o]=e[o]||function(){(e[o].q=e[o].q||[]).push(arguments)},e[o].l=1*new Date,c=t.createElement(a),i=t.getElementsByTagName(a)[0],c.async=1,c.src=n,i.parentNode.insertBefore(c,i)}(window,document,"script","https://www.google-analytics.com/analytics.js","ga"),ga("create","UA-59996358-2","transcendent-ai-labs.github.io/DynaML/"),ga("set","anonymizeIp",!0),ga("send","pageview");var links=document.getElementsByTagName("a");Array.prototype.map.call(links,function(e){e.host!=document.location.host&&e.addEventListener("click",function(){var t=e.getAttribute("data-md-action")||"follow";ga("send","event","outbound",t,e.href)})});var query=document.forms.search.query;query.addEventListener("blur",function(){if(this.value){var e=document.location.pathname;ga("send","pageview",e+"?q="+this.value)}})</script>
      
    
  </body>
</html>